---
title: "Statistical Process Control (SPC)"
image: nhsrplotthedots.png
author:
  - name: Sammi Rosser
    affiliation: Health Service Modelling Associates (HSMA), NIHR PenARC
pub-info:
  abstract: |
    SPC charts are a useful tool for monitoring and reporting, allowing KPIs to be looked at over time and in the context of expected variation, moving away from some of the pitfalls of traditional RAG reporting and providing insights into trends and, if there is a target, whether it is likely to be reliably met.
date: "2025-12-01T15:25:10+00:00"
---

:::{.callout-tip}
Find out more about the technique in the Atlas entry [here](../../techniques/spc/spc.qmd).
:::

::: {.r-content}

The most popular solution for SPC charts in R is the NHSRplotthedots package.

You can find out more about the package in the Atlas entry [here](../../packages_projects_tools/nhsrplotthedots/nhsrplotthedots.qmd)

Below is a sample code snippet that makes an SPC chart for a time series.

```{webr-r}
#| context: setup
#| warning: false
#| message: false
webr::install("NHSRplotthedots")
webr::install("NHSRdatasets")
```

First, we import our NHS R plot the dots package.

In this case, rather than using real data, we'll be using a sample dataset of ED attendances provided by the NHSRdatasets library package.

```{webr-r}
#| read-only: true
#| autorun: true
library(NHSRplotthedots)
library(NHSRdatasets)
library(dplyr)

NHSRdatasets::ae_attendances |> head()
```

Now we'll filter our dataset down to just one organisation, type 1 attendances only, and a shorter period of time.

```{webr-r}
#| read-only: true
#| autorun: true
sub_set <- NHSRdatasets::ae_attendances |>
  filter(org_code == "RQM", type == 1, period < as.Date("2018-04-01"))

sub_set
```

We can take this subset of data and use the NHSRplotthedots library.

```{webr-r}
#| read-only: true
#| autorun: false
#| warning: false
#| message: false
#| output: false
sub_set |>
  NHSRplotthedots::ptd_spc(
    value_field = breaches,
    date_field = period,
    improvement_direction = "decrease"
  ) |>
  NHSRplotthedots::ptd_create_ggplot(
    y_axis_label = "4-hour wait breaches",
    main_title = "SPC of A&E waiting time breaches for RQM"
  )
```

![](nhsrptd-example.png){height="400px"}

:::{.callout-note}
Code Source: NHSR Plot the Dots Documentation @ <https://nhsrplotthedots.nhsrcommunity.com/>
:::

:::{.callout-tip collapse="true"}
### Click here to view and copy the whole example

```r
install.packages("NHSRplotthedots")
install.packages("NHSRdatasets")

library(NHSRdatasets)

library(NHSRplotthedots)
library(dplyr)

sub_set <- ae_attendances |>
  filter(org_code == "RQM", type == 1, period < as.Date("2018-04-01"))

sub_set |>
  NHSRplotthedots::ptd_spc(
    value_field = breaches,
    date_field = period,
    improvement_direction = "decrease"
  ) |>
  NHSRplotthedots::ptd_create_ggplot(
    y_axis_label = "4-hour wait breaches",
    main_title = "SPC of A&E waiting time breaches for RQM"
)
```

:::


:::

::: {.python-content}

:::{.callout-warning}

There is not currently an actively maintained, production-ready equivalent to the NHS R plot the dots programme.

One of the major benefits of the NHS-aligned packages are that they use the recognised , as well as 'making data count' defaults for values such as the number of points that are considered a run.

You may wish to consider reviving a project such as [nhspy-plotthedots](../../packages_projects_tools/nhspy-plotthedots/nhspy-plotthedots.qmd).

:::

:::
